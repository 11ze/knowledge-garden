---

title: 11｜怎么给字符串字段加索引？
tags:
- MySQL
- mindmap-plugin: basic
publishDate: 2023-05-17T15:19:11+08:00

---

- 1. 直接创建完整索引，这样可能比较占用空间；

- 2. 创建前缀索引，节省空间，但会增加查询扫描次数，并且不能使用覆盖索引；

    - 即使前缀完全覆盖了字段内容也会回表，因为不确定是不是真的完整数据


    - 在索引上找到数据后还需要回到主键上拿到完整数据进行判断

- 3. 倒序存储，再创建前缀索引，用于绕过字符串本身前缀的区分度不够的问题，不支持范围扫描；
    - index index_name(email(6));

- 4. 创建 hash 字段索引，查询性能稳定，有额外的存储和计算消耗，需要多一个字段保存 hash 字段，不支持范围扫描。
    - 比如通过 crc32() 函数得到 hash 值

- 思考题

    - 如果你在维护一个学校的学生信息数据库，学生登录名的统一格式是”学号 @gmail.com", 而学号的规则是：十五位的数字，其中前三位是所在城市编号、第四到第六位是学校编号、第七位到第十位是入学年份、最后五位是顺序编号。


    - 系统登录的时候都需要学生输入登录名和密码，验证正确后才能继续使用系统。就只考虑登录验证这个行为的话，你会怎么设计这个登录名的索引呢？

        - 正向反向的前缀索引重复度都比较高


        - 只是维护一个学校


        - 因此可以只存入学年份 + 顺序编号，长度是 9 位


        - 可以用数字类型来存，只占用 4 个字节，属于最简单的 hash 转换规则


        - 更好的做法：学校数据不多，直接整个保存
